---
# handlers file for raspi_boot_config
# - name: Reboot
#   when: raspi_boot_config_allow_reboot | default(false)
#   ansible.builtin.command: sleep 2 && /sbin/shutdown -r now 'Rebooting to update pi boot configuration'
#   changed_when: false
#   async: 300
#   poll: 0
#   # ignore_errors: true
- name: Reboot
  when: raspi_boot_config_allow_reboot | default(false)
  ansible.builtin.reboot:
    reboot_timeout: 60

- name: Emit reboot required
  ansible.builtin.file:
    path: /var/run/reboot-required
    state: touch
    mode: "0644"
    modification_time: preserve
    access_time: preserve
